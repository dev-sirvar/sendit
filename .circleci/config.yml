
  version: 2
  jobs:
    build:
      docker:
        - image: circleci/python:3.6.1
  
      working_directory: ~/repo
  
      steps:
        - checkout
  
        - run:
            name: install send
            command: |
              sudo pip3 install sendclient
  
        - run:
            name: install aria2
            command: |
              sudo apt-get install aria2
              
        - run:
            name: install zip
            command: |
              sudo apt-get install zip
        
        - run:
            name: chmod x send file
            command: |
              chmod +x ./sendit.sh
              
        - run:
            name: make temp dir
            command: |
              mkdir ${CIRCLE_BRANCH}
  
        - run:
            name: download with aria2
            command: |
              aria2c -d ${CIRCLE_BRANCH} --seed-time=2 --seed-ratio=0.1 'magnet:?xt=urn:btih:5DE95CB5530DA99CD1CEE47A7EA8AA2F86F20F51&dn=Satyameva+Jayate+%282018%29+%5BHDCAM+x264%5D+%5BHindi+AAC%5D+%28Starshade%29&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=UDP%3A%2F%2FTRACKER.LEECHERS-PARADISE.ORG%3A6969%2FANNOUNCE&tr=UDP%3A%2F%2FTRACKER.COPPERSURFER.TK%3A6969%2FANNOUNCE&tr=UDP%3A%2F%2FTRACKER.OPENTRACKR.ORG%3A1337%2FANNOUNCE&tr=UDP%3A%2F%2FTRACKER.ZER0DAY.TO%3A1337%2FANNOUNCE&tr=UDP%3A%2F%2FEDDIE4.NL%3A6969%2FANNOUNCE&tr=udp%3A%2F%2Ftracker.vanitycore.co%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.internetwarriors.net%3A1337&tr=udp%3A%2F%2Ftracker.zer0day.to%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969%2Fannounce&tr=udp%3A%2F%2Fcoppersurfer.tk%3A6969%2Fannounce'
  
        - run:
            name: zip file
            command: |
              zip -r ${CIRCLE_BRANCH}.zip ${CIRCLE_BRANCH}
              
        - run:
            name: send file
            command: |
              ./sendit.sh ${CIRCLE_BRANCH}.zip | xargs -I {} curl -k -d "{"state":"success","target_url":"{}","context":"sendit"}" -X POST "https://api.github.com/repos/dev-sirvar/sendit/commits/${CIRCLE_SHA1}/statuses?access_token=${GITHUB_TOKEN}"  
  